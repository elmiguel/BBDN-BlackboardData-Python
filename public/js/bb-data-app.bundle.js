/*! For license information please see bb-data-app.bundle.js.LICENSE.txt */
!function(t){var e={};function s(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=e,s.d=function(t,e,a){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(a,r,function(e){return t[e]}.bind(null,r));return a},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s="./client/ts/bb-data-app.ts")}({"./client/ts/bb-data-app.ts":function(t,e,s){"use strict";s.r(e);var a=s("./client/ts/components/bb-data-basic-table.ts"),r=s("./client/ts/components/bb-data-basic-table-alt.ts");customElements.define("bb-data-table-basic",a.a),customElements.define("bb-data-table-basic-alt",r.a);const n=window.document.getElementById("bb-data-demo"),o=window.document.querySelectorAll(".query");console.log(o),o.forEach((function(t,e,s){console.log(t,e,s),t.addEventListener("click",(function(t){t.preventDefault();const e=t.target,s=JSON.parse(e.dataset.queryConfig);console.log(s),n.setAttribute("queryname",s.queryname)}))}))},"./client/ts/bb-data-variables.ts":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));const a={host:"http://localhost:5000"}},"./client/ts/components/bb-data-basic-table-alt.ts":function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var a=s("./client/ts/core/bb-data-abstract-class.ts"),r=s("./client/ts/core/bb-data-service.ts"),n=s("./client/ts/core/bb-data-state.ts"),o=function(t,e,s,a){return new(s||(s=Promise))((function(r,n){function o(t){try{c(a.next(t))}catch(t){n(t)}}function i(t){try{c(a.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,i)}c((a=a.apply(t,e||[])).next())}))};class i extends a.a{constructor(){super(),this.bbDataService=new r.a,this.unsubscribe=new rxjs.Subject,this.self=this,this.template=window.document.getElementById("bb-data-table-basic-tmpl"),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.template.content.cloneNode(!0)),this.queryName=this.getAttribute("queryname"),this.select=this.getAttribute("select"),this.type=this.getAttribute("type"),this.format=this.getAttribute("format"),console.log(`[queryName] ${this.queryName}`),this.data=this.bbDataService.runQuery(this.queryName),this.dataState=new n.a(this.queryName)}static get observedAttributes(){return["queryname","select","type","format"]}connectedCallback(){this.data.pipe(rxjs.operators.takeUntil(this.unsubscribe),rxjs.operators.filter(t=>null!==t),rxjs.operators.switchMap(t=>o(this,void 0,void 0,(function*(){return t}))),rxjs.operators.tap(t=>{console.log("some random log....."),console.log(t)})).subscribe(t=>{this.dataState.updateState(t),this.updateTable(t)})}disconnectedCallback(){this.unsubscribe.next()}attributeChangedCallback(t,e,s){return o(this,void 0,void 0,(function*(){if(e!==s&&(console.log(t,e,s),"queryname"===t&&s)){const e=yield this.bbDataService.runQuery(s);console.log("changing data.........."),console.log(e),e.pipe(rxjs.operators.take(1),rxjs.operators.switchMap(t=>rxjs.from(t)),rxjs.operators.tap(t=>{console.log("We have new updated data!!!!!"),console.log("========="),console.log(t),console.log("=========")})).subscribe(t=>this.data.next(rxjs.of(t))),this[t]=s}}))}updateTable(t){this.table=this.shadowRoot.querySelector("table"),this.table.innerHTML="",this.dataTable=null,console.log("in bewtween data loading......."),this.dataTable=new simpleDatatables.DataTable(this.table,{data:t,columns:[{select:+this.select,type:this.type,format:this.format}]})}}},"./client/ts/components/bb-data-basic-table.ts":function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var a=s("./client/ts/core/bb-data-abstract-class.ts"),r=s("./client/ts/core/bb-data-service.ts"),n=s("./client/ts/core/bb-data-state.ts"),o=function(t,e,s,a){return new(s||(s=Promise))((function(r,n){function o(t){try{c(a.next(t))}catch(t){n(t)}}function i(t){try{c(a.throw(t))}catch(t){n(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(o,i)}c((a=a.apply(t,e||[])).next())}))};class i extends a.a{constructor(){super(),this.bbDataService=new r.a,this.unsubscribe=new rxjs.Subject,this.self=this,this.template=window.document.getElementById("bb-data-table-basic-tmpl"),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.template.content.cloneNode(!0)),this.queryName=this.getAttribute("queryName"),this.select=this.getAttribute("select"),this.type=this.getAttribute("type"),this.format=this.getAttribute("format"),this.data=this.bbDataService.runQuery(this.queryName),this.dataState=new n.a(this.queryName)}static get observedAttributes(){return["queryname","select","type","format"]}connectedCallback(){this.data.pipe(rxjs.operators.takeUntil(this.unsubscribe),rxjs.operators.filter(t=>null!==t),rxjs.operators.switchMap(t=>o(this,void 0,void 0,(function*(){return t}))),rxjs.operators.tap(t=>{console.log("some random log....."),console.log(t)})).subscribe(t=>{this.dataState.updateState(t),this.updateTable(t)})}disconnectedCallback(){this.unsubscribe.next()}attributeChangedCallback(t,e,s){return o(this,void 0,void 0,(function*(){if(e!==s&&(console.log(t,e,s),"queryname"===t&&s)){const e=yield this.bbDataService.runQuery(s);console.log("changing data.........."),console.log(e),e.pipe(rxjs.operators.take(1),rxjs.operators.switchMap(t=>rxjs.from(t)),rxjs.operators.tap(t=>{console.log("We have new updated data!!!!!"),console.log("========="),console.log(t),console.log("=========")})).subscribe(t=>this.data.next(rxjs.of(t))),this[t]=s}}))}updateTable(t){this.table=this.shadowRoot.querySelector("table"),this.table.innerHTML="",console.log("in bewtween data loading......."),this.dataTable=new simpleDatatables.DataTable(this.table,{data:t,columns:[{select:+this.select,type:this.type,format:this.format}]})}}},"./client/ts/core/bb-data-abstract-class.ts":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));class a extends HTMLElement{constructor(){super();const t=this;window.irsc||(window.irsc={}),t.constructor.observedAttributes&&t.constructor.observedAttributes.length&&t.constructor.observedAttributes.forEach(t=>{"data"!==t&&(/[-]/gim.test(t)&&(t=this.pascalCase(t)),Object.defineProperty(this,t,{get(){return this.getAttribute(t)},set(e){e?this.setAttribute(t,e):this.removeAttribute(t)}}))})}attributeChangedCallback(t,e,s){const a=this[`slot${this.titleize(this.pascalCase(t))}`];a&&(a.innerText=s)}pascalCase(t){return t.split("-").map((t,e)=>0===e?t:this.titleize(t)).join("")}titleize(t){return t.charAt(0).toUpperCase()+t.slice(1)}}},"./client/ts/core/bb-data-service.ts":function(t,e,s){"use strict";s.d(e,"a",(function(){return r}));var a=s("./client/ts/bb-data-variables.ts");class r{constructor(){this.unsubscribe=new rxjs.Subject,this.bbDataUrl=`${a.a.host}/queries`,window.hasOwnProperty("bbdata")||(window.bbdata={}),window.irsc.hasOwnProperty("BbDataService")||(window.irsc.PathwayService=this),this.bbdata=window.bbdata}runQuery(t,e=null){if("test"===t||""===t){const t=`${a.a.host}/test`;return new rxjs.BehaviorSubject(rxjs.of(fetch(t).then(t=>t.json()).catch(t=>{console.log("There was a problem loading test query....."),console.log(t)}))).pipe(rxjs.operators.switchMap(t=>t))}if(!this.bbdata.hasOwnProperty(t)){this.bbdata[t]=null;const e=fetch(`${this.bbDataUrl}/${t}`).then(t=>t.json()).then(t=>t).catch(e=>{console.log(`There was an error in retrieving data with queryName: ${t}`),console.log(e)});this.bbdata[t]=new rxjs.BehaviorSubject(e)}return this.bbdata[t].pipe(rxjs.operators.takeUntil(this.unsubscribe),rxjs.operators.switchMap(t=>rxjs.from(t)))}disconnectedCallback(){this.unsubscribe.next(null)}}},"./client/ts/core/bb-data-state.ts":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));class a{constructor(t){this._unsubscribe=new rxjs.Subject;this.state=new rxjs.BehaviorSubject({}).pipe(rxjs.operators.filter(e=>e&&e[t]))}updateState(t){this.state.next(t)}getStateSlice(t){return this.state.pipe(rxjs.operators.pluck(t))}freeze(){this._unsubscribe.next(null)}}}});
//# sourceMappingURL=bb-data-app.bundle.map