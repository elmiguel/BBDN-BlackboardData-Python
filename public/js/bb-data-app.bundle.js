/*! For license information please see bb-data-app.bundle.js.LICENSE.txt */
!function(t){var e={};function a(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=e,a.d=function(t,e,s){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(a.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(s,n,function(e){return t[e]}.bind(null,n));return s},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s="./client/ts/bb-data-app.ts")}({"./client/ts/bb-data-app.ts":function(t,e,a){"use strict";a.r(e);var s=a("./client/ts/components/bb-data-basic-table-alt-2.ts");customElements.define("bb-data-table-basic-alt2",s.a);const n=window.document.getElementById("bb-data-demo");window.document.querySelectorAll(".query").forEach((function(t){t.addEventListener("click",(function(t){t.preventDefault();const e=t.target,a=JSON.parse(e.dataset.queryConfig);n.setAttribute("queryname",a.queryname)}))}))},"./client/ts/bb-data-variables.ts":function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));const s={host:"http://localhost:5000"}},"./client/ts/components/bb-data-basic-table-alt-2.ts":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var s=a("./client/ts/core/bb-data-abstract-class.ts"),n=a("./client/ts/core/bb-data-service.ts"),o=a("./client/ts/core/bb-data-state.ts"),r=function(t,e,a,s){return new(a||(a=Promise))((function(n,o){function r(t){try{c(s.next(t))}catch(t){o(t)}}function i(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof a?e:new a((function(t){t(e)}))).then(r,i)}c((s=s.apply(t,e||[])).next())}))};class i extends s.a{constructor(){super(),this.dataTable=null,this.bbDataService=new n.a,this.unsubscribe=new rxjs.Subject,this.self=this,this.template=window.document.getElementById("bb-data-table-basic-tmpl-alt"),this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(this.template.content.cloneNode(!0)),this.queryName=this.getAttribute("queryname"),this.select=this.getAttribute("select"),this.type=this.getAttribute("type"),this.format=this.getAttribute("format"),this.dataState=new o.a,console.log(`[queryName] ${this.queryName}`),this.dataState.state.pipe(rxjs.operators.takeUntil(this.unsubscribe),rxjs.operators.filter(()=>null!==this.queryName)).subscribe(t=>{console.log("Data State Changed!"),console.log("=".repeat(10)),console.log(t),console.log("=".repeat(10))})}static get observedAttributes(){return["queryname","select","type","format"]}connectedCallback(){}disconnectedCallback(){this.unsubscribe.next()}attributeChangedCallback(t,e,a){return r(this,void 0,void 0,(function*(){if(e!==a&&"queryname"===t&&a){console.log(t,e,a),this[t]=a;const s=yield this.bbDataService.runQuery2(a);this.data=s[a],console.log("[change detection]",this.data),this.updateTable()}}))}updateTable(){console.log("[updateTable] re-rendering table data..."),console.log("=== DATA ===/>",this.data),this.table=this.shadowRoot.querySelector("table"),null!==this.dataTable&&this.dataTable.destroy(),this.dataTable=new simpleDatatables.DataTable(this.table,{data:this.data,columns:[{select:+this.select,type:this.type,format:this.format}]})}}},"./client/ts/core/bb-data-abstract-class.ts":function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));class s extends HTMLElement{constructor(){super();const t=this;window.irsc||(window.irsc={}),t.constructor.observedAttributes&&t.constructor.observedAttributes.length&&t.constructor.observedAttributes.forEach(t=>{"data"!==t&&(/[-]/gim.test(t)&&(t=this.pascalCase(t)),Object.defineProperty(this,t,{get(){return this.getAttribute(t)},set(e){e?this.setAttribute(t,e):this.removeAttribute(t)}}))})}attributeChangedCallback(t,e,a){if(e!==a){console.log("Abstract attributeChangedCallback....");const e=this[`slot${this.titleize(this.pascalCase(t))}`];e&&(e.innerText=a)}}pascalCase(t){return t.split("-").map((t,e)=>0===e?t:this.titleize(t)).join("")}titleize(t){return t.charAt(0).toUpperCase()+t.slice(1)}}},"./client/ts/core/bb-data-service.ts":function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));var s=a("./client/ts/bb-data-variables.ts"),n=a("./client/ts/core/bb-data-state.ts"),o=function(t,e,a,s){return new(a||(a=Promise))((function(n,o){function r(t){try{c(s.next(t))}catch(t){o(t)}}function i(t){try{c(s.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof a?e:new a((function(t){t(e)}))).then(r,i)}c((s=s.apply(t,e||[])).next())}))};class r{constructor(){this.bbDataUrl=`${s.a.host}/queries`,this.dataState=new n.a,window.hasOwnProperty("bbdata")||(window.bbdata={}),window.irsc.hasOwnProperty("BbDataService")||(window.irsc.PathwayService=this),this.bbdata=window.bbdata}isTest(t){return!t||"test"===t||""===t||void 0===t}runQuery(t,e=null){console.log(`[BbDataState.runQuery('${t}', ${e})]`),this.isTest(t)?(console.log(`${s.a.host}/test`),fetch(`${s.a.host}/test`).then(t=>t.json()).then(e=>{console.log(e);const a={};a[t]=e,this.dataState.updateState(a)}).catch(t=>{console.log("There was a problem loading test query....."),console.log(t)})):(console.log("this should not run if test!!!!"),this.bbdata.hasOwnProperty(t)||this.isTest(t)||fetch(`${this.bbDataUrl}/${t}`).then(t=>t.json()).then(e=>{console.log(e);const a={};a[t]=e,this.dataState.updateState(a)}).catch(e=>{console.log(`There was an error in retrieving data with queryName: ${t}`),console.log(e)}))}runQuery2(t,e=null){return o(this,void 0,void 0,(function*(){console.log(`[BbDataService.runQuery('${t}', ${e})]`);let a="";a=this.isTest(t)?`${s.a.host}/test`:`${this.bbDataUrl}/${t}`,console.log(`${s.a.host}/test`);try{const e=yield fetch(a).then(t=>t.json());console.log("[BbDataService.runQuery.fetch(url)]...",e);const s={};return s[t]=e,s}catch(e){console.log(`There was an error in retrieving data with queryName: ${t}`),console.log(e)}}))}}},"./client/ts/core/bb-data-state.ts":function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));class s{constructor(){this._unsubscribe=new rxjs.Subject,window.hasOwnProperty("bbdata")||(window.bbdata={}),window.bbdata.hasOwnProperty("BbDataState")||(window.bbdata.BbDataState=this);this.state=new rxjs.BehaviorSubject({}).pipe(rxjs.operators.distinctUntilChanged(),rxjs.operators.filter(t=>t))}updateState(t){console.log("[BbDataState.updateState()]",t),this.state.next(t);const e=new CustomEvent("bb-data-update",{detail:t,bubbles:!0,composed:!0});window.document.querySelectorAll("[class*='bb-data-table']").forEach(t=>{t.dispatchEvent(e)})}getStateSlice(t){return this.state.pipe(rxjs.operators.pluck(t))}freeze(){this._unsubscribe.next(null)}}}});
//# sourceMappingURL=bb-data-app.bundle.map